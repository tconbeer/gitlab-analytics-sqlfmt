with
    source as (

        select * from {{ ref("gitlab_dotcom_vulnerability_occurrences_dedupe_source") }}

    )
select
    id::number as id,
    sha2(randstr(32, project_id::number) || project_id::varchar)::varchar as project_id,
    scanner_id::number as vulnerability_scanner_id,
    primary_identifier_id::number as vulnerability_primary_identifier_id,
    vulnerability_id::float as vulnerability_id,
    created_at::timestamp as vulnerability_created_at,
    updated_at::timestamp as vulnerability_updated_at,
    severity::number as vulnerability_severity,
    confidence::number as vulnerability_confidence,
    report_type::number as vulnerability_report_type,
    uuid::text as vulnerability_uuid,
    name::varchar as vulnerability_name,
    metadata_version::text as vulnerability_metadata_version,
    raw_metadata::text as vulnerability_raw_metadata
from source
